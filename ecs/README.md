# CSV

| 項目名 | 必須/任意 | 説明 | 補足 |
|---|---|---|---|
| **REGION** | 必須 | AWSリージョン名 | 例: `ap-northeast-1` |
| **ACTION** | 必須 | 実行するアクション | `add` (作成/更新) または `remove` (削除)。`remove` 時は、ECSサービスの削除に加えて、関連するオートスケーリングポリシーとスケーラブルターゲットの登録解除も自動的に行われます。`desired-count` は0に設定され、タスクが停止した後にサービスが削除されます。 |
| **CLUSTER_NAME** | 必須 | ECSクラスター名 | 既存のECSクラスターを指定してください。 |
| **TASK_DEFINITION_NAME** | 必須 | タスク定義名とリビジョン | `family:revision` 形式 (例: `sample-fargate:7`) で指定します。`add` アクションの場合、サービス作成時または更新時にこのリビジョンのタスク定義に切り替わります。 |
| **SERVICE_NAME** | 必須 | 作成または管理するECSサービス名 | この名前でECSサービスが識別されます。 |
| **LAUNCH_TYPE** | 必須 | 起動タイプ | `FARGATE` または `EC2` を指定します。 |
| **DESIRED_COUNT** | 必須 | 希望するタスク数 | `add` アクションの場合、サービス作成時の初期タスク数または更新後の希望タスク数を指定します。`remove` アクションの場合はこの値は無視され、自動的に `0` に設定されます。 |
| **SUBNETS** | 必須 | サブネットIDまたはNameタグ | サービスをデプロイするサブネットを1つ以上指定します。複数指定する場合はセミコロン `;` で区切ります (例: `subnet-123;subnet-456`)。サブネットID (`subnet-xxx`) またはNameタグの値のどちらでも指定可能です。 |
| **SECURITY_GROUPS** | 必須 | セキュリティグループIDまたはNameタグ | サービスに適用するセキュリティグループを1つ以上指定します。複数指定する場合はセミコロン `;` で区切ります (例: `sg-123;webserver-sg`)。セキュリティグループID (`sg-xxx`) またはグループ名のどちらでも指定可能です。 |
| **PUBLIC_IP** | 必須 | パブリックIP割り当て | Fargate起動タイプの場合に、タスクにパブリックIPアドレスを割り当てるかどうかを指定します。`ENABLED` (割り当てる) または `DISABLED` (割り当てない) を指定します。 |
| **TARGET_GROUP** | 必須 | ターゲットグループARNまたは名前 | ECSサービスがApplication Load Balancer (ALB) または Network Load Balancer (NLB) と連携する場合に指定します。ターゲットグループのARN (例: `arn:aws:elasticloadbalancing:...`) または名前 (例: `tg-ecs`) のどちらでも指定可能です。 |
| **CONTAINER_NAME** | 必須 | コンテナ名 | `TARGET_GROUP` と連携するコンテナの名前を指定します。タスク定義内のコンテナ名と一致させる必要があります。 |
| **CONTAINER_PORT** | 必須 | コンテナポート | `TARGET_GROUP` と連携するコンテナのポート番号を指定します (例: `80`)。 |
| **HEALTH_CHECK_PERIOD** | 任意 | ヘルスチェック猶予期間(秒) | サービスが初めて起動した後、ロードバランサーのヘルスチェックが開始されるまでの待機時間を秒単位で指定します。デフォルトは `60` 秒です。 |
| **MIN_CAPACITY** | 必須 | オートスケーリング最小タスク数 | ECSサービスのオートスケーリングにおける最小タスク数を指定します。`0` 以上の整数値を指定してください。`remove` アクションの場合はこの値は無視されます。 |
| **MAX_CAPACITY** | 必須 | オートスケーリング最大タスク数 | ECSサービスのオートスケーリングにおける最大タスク数を指定します。`MIN_CAPACITY` 以上の整数値を指定してください。`remove` アクションの場合はこの値は無視されます。 |
| **TARGET_VALUE** | 必須 | オートスケーリングターゲット値(%) | CPU使用率に基づいたターゲット追跡スケーリングポリシーの閾値をパーセンテージで指定します (例: `70.0` = 70%)。 |
| **SCALE_OUT_COOLDOWN** | 必須 | スケールアウトクールダウン(秒) | スケールアウトイベントが発生した後、次のスケールアウトアクティビティを開始するまでに待機する時間を秒単位で指定します (例: `300` = 5分)。 |
| **SCALE_IN_COOLDOWN** | 必須 | スケールインクールダウン(秒) | スケールインイベントが発生した後、次のスケールインアクティビティを開始するまでに待機する時間を秒単位で指定します (例: `600` = 10分)。 |
| **TAGS** | 任意 | タグ付け | ECSサービスに適用するタグを `Key:Value` 形式で指定します (例: `Environment:Production`)。複数のタグを指定する場合はセミコロン `;` で区切ります (例: `Env:Prod;Team:Dev`)。不正な形式のタグはスキップされます。 |
| **DEPLOYMENT_CONTROLLER** | 任意 | デプロイコントローラータイプ | サービスのデプロイ戦略を指定します。`ECS` (デフォルトのローリングアップデート) または `CODE_DEPLOY` (AWS CodeDeployによるBlue/Greenデプロイ) を指定できます。この設定はサービス新規作成時にのみ有効です。 |

