# CSV 

## optiongroups.csv  

| 列名                | 説明                                                                                                | 必須 | 補足                                                                 |
| :------------------ | :-------------------------------------------------------------------------------------------------- | :--- | :------------------------------------------------------------------- |
| `REGION`            | 対象となるAWSリージョン名 (例: `ap-northeast-1`)                                                    | 必須 | AWS CLIがアクセス権を持つリージョンである必要があります。            |
| `OPTION_GROUP_NAME` | 作成または設定対象となるRDSオプショングループの名前                                                   | 必須 | RDSの命名規則に従う必要があります。                                  |
| `ENGINE_NAME`       | RDSデータベースエンジンの種類 (例: `mysql`, `oracle-ee`, `sqlserver-se`)                           | 必須 | サポートされているエンジンの名前を指定してください。                 |
| `ENGINE_VERSION`    | データベースエンジンのメジャーバージョン。`create-option-group` コマンドで使用される形式である必要があります。 (例: `8.0`, `19`, `15.00`) | 必須 | 指定したエンジン名と一致するメジャーバージョンである必要があります。 |
| `DESCRIPTION`       | 作成するオプショングループの説明文                                                                  | 必須 |                                                                      |
| `OPTIONS_JSON`      | オプショングループに追加するオプション設定を記述したJSONファイルへのパス。スクリプト内では`OPTIONS_JSON_PATH`変数として扱われます。 | 必須 (オプション追加処理を行う場合) | JSONファイルが見つからない場合、その行のオプション追加処理はスキップされます。 |



## aurora_config.csv 

| 列名                       | 説明                                                                                                                                                                                             | 必須/任意                                                                                                | 補足                                                                                                                                                                                                                                                              |
| :--------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `REGION`                     | AWS リージョン                                                                                                                                                                                   | (必須)                                                                                                   | 例: `ap-northeast-1`, `us-east-1`                                                                                                                                                                                                                               |
| `DB_IDENTIFIER`              | 作成または管理対象の Aurora クラスター識別子                                                                                                                                                     | (必須)                                                                                                   | 英小文字、数字、ハイフンで始まり、英小文字、数字、ハイフン、ピリオドを含む、長さ 1-63 文字。末尾はハイフン以外。重複不可。                                                                                                                                                                 |
| `ENGINE`                     | 使用するデータベースエンジン                                                                                                                                                                     | (必須)                                                                                                   | `aurora-mysql` または `aurora-postgresql`                                                                                                                                                                                                                         |
| `ENGINE_VERSION`             | データベースエンジンバージョン                                                                                                                                                                     | (新規作成時必須)<br>(復元時任意)                                                                           | 新規作成時には必須です。復元時には、指定すると復元と同時にメジャーバージョンアップを行うことができます（`restore-db-cluster-from-snapshot` では `--allow-major-version-upgrade` は使えません）。 例: `8.0.mysql_aurora.3.04.0`, `15.4` など                               |
| `DB_INSTANCE_CLASS`          | DB インスタンスクラス                                                                                                                                                                            | (インスタンス管理時必須)                                                                                   | `AURORA_INSTANCE_COUNT` が1以上の場合に、インスタンス作成・管理に必要です。 例: `db.t3.medium`, `db.r6g.large` など。利用可能なインスタンスタイプはエンジンやバージョン、リージョンによります。                                                                                           |
| `CLUSTER_PARAMETER_GROUP`    | 適用する DB クラスターパラメータグループ名                                                                                                                                                       | (任意)                                                                                                   | 既存の DB クラスターパラメータグループ名                                                                                                                                                                                                                          |
| `INSTANCE_PARAMETER_GROUP`   | 適用する DB インスタンスパラメータグループ名                                                                                                                                                   | (任意)                                                                                                   | 既存のDBインスタンスパラメータグループ名                                                                                                                                                                                                            |
| `SECURITY_GROUPS`            | 適用する VPC セキュリティグループ名または ID                                                                                                                                                   | (任意)                                                                                                   | 既存のセキュリティグループ名または ID (`sg-xxxxxxxxxxxxxxxxx`)。複数指定する場合はセミコロン (`;`) で区切ります。例: `test-rds-sg;sg-040cbdf6d8b8c55d0`                                                                                                          |
| `DB_SUBNET_GROUP`            | 関連付ける DB サブネットグループ名                                                                                                                                                               | (新規作成・復元時必須)                                                                                     | 既存の DB サブネットグループ名                                                                                                                                                                                                                                    |
| `MASTER_USERNAME`            | マスターユーザー名                                                                                                                                                                             | (新規作成時:<br>`SECRET_MANAGER_ARN` 未指定の場合必須)                                                    | 新規作成時で `SECRET_MANAGER_ARN` を指定しない場合に必須です。 半角英数字など (Aurora MySQL: 1-16文字, Aurora PostgreSQL: 1-63文字)。Secrets Manager を使用する場合は不要。                                                                                                 |
| `MASTER_PASSWORD`            | マスターパスワード                                                                                                                                                                             | (新規作成時:<br>`SECRET_MANAGER_ARN` 未指定の場合必須)                                                    | 新規作成時で `SECRET_MANAGER_ARN` を指定しない場合に必須です。パスワードポリシーに準拠する必要があります。Secrets Manager を使用する場合は不要。                                                                                                                               |
| `DB_NAME`                    | 初期データベース名                                                                                                                                                                             | (任意)                                                                                                   | 指定しない場合は自動生成されるか、作成されません。 例: `devdb`, `stagedb`                                                                                                                                                                                               |
| `BACKUP_RETENTION`           | 自動バックアップの保持期間 (日数)                                                                                                                                                                | (任意)                                                                                                   | `1` から `35` までの整数 (エンジンやエディションによる)。省略時はデフォルト値が適用されます。                                                                                                                                                                              |
| `PREFERRED_BACKUP_WINDOW`    | 自動バックアップが実行される時間帯 (UTC)                                                                                                                                                         | (任意)                                                                                                   | `hh24:mi-hh24:mi` 形式。例: `04:00-05:00`                                                                                                                                                                                                                          |
| `PREFERRED_MAINTENANCE_WINDOW`| システムメンテナンスが許可される時間帯 (UTC)                                                                                                                                                     | (任意)                                                                                                   | `day:hh24:mi-day:hh24:mi` 形式。例: `fri:22:00-fri:23:00`, `sat:02:00-sat:03:00`                                                                                                                                                                                     |
| `IAM_AUTH`                   | IAM データベース認証の有効化                                                                                                                                                                     | (任意)                                                                                                   | `TRUE`, `FALSE`                                                                                                                                                                                                                                                 |
| `CLOUDWATCH_LOGS_EXPORTS`    | CloudWatch Logs にエクスポートするログタイプ。複数指定する場合はセミコロン (`;`) で区切ります。                                                                                                   | (任意)                                                                                                   | エンジンによって異なります (`audit`, `error`, `general`, `slowquery`, `postgresql` など)。例: `audit;error`, `postgresql`                                                                                                                                         |
| `DELETION_PROTECTION`        | クラスターの削除保護の有効化                                                                                                                                                                     | (任意)                                                                                                   | `TRUE`, `FALSE`                                                                                                                                                                                                                                                 |
| `PUBLICLY_ACCESSIBLE`        | クラスターエンドポイントがパブリックにアクセス可能か                                                                                                                                               | (任意)                                                                                                   |  通常はセキュリティのために `FALSE` にすべきです。                                                                                                                                                                     |
| `ENABLE_PERFORMANCE_INSIGHTS`| Performance Insights の有効化                                                                                                                                                                    | (任意)                                                                                                   | `TRUE`, `FALSE`                                                                                                                                                                                                                                                 |
| `PERFORMANCE_INSIGHTS_RETENTION`| Performance Insights のデータ保持期間 (日数)                                                                                                                                                     | (任意)                                                                                                   | `ENABLE_PERFORMANCE_INSIGHTS` が `TRUE` の場合に有効です。 `7` または拡張保持期間のいずれか (`31`, `62`, ... , `731` など)。                                                                                                                                             |
| `AURORA_INSTANCE_COUNT`      | 作成・管理する DB インスタンスの**総数** (プライマリインスタンス含む)                                                                                                                            | (任意)                                                                                                   | `1` 以上の整数。1 はプライマリのみ、2以上は指定数のリードレプリカも作成/維持します。0以下の値はインスタンス管理処理がスキップされます。                                                                                                                                          |
| `TAGS`                       | クラスターに適用する AWS タグ。複数指定する場合はセミコロン (`;`) で区切ります。                                                                                                                 | (任意)                                                                                                   | `Key=Value` 形式。例: `Env=Development;CostCenter=IT;ManagedBy=Script`                                                                                                                                                                                          |
| `SNAPSHOT_IDENTIFIER`        | 復元元の DB スナップショットの識別子                                                                                                                                                             | (復元時:<br>`SOURCE_DB_IDENTIFIER` 未指定の場合必須)                                                      | 指定する場合、`SOURCE_DB_IDENTIFIER` は指定しません。 既存の DB スナップショット ID。 例: `test-my-sql-snapshot`, `snap-test-postgre-cluster`                                                                                                                            |
| `SOURCE_DB_IDENTIFIER`       | ポイントインタイムリカバリ (PITR) を行うソース DB クラスターの識別子                                                                                                                             | (復元時:<br>`SNAPSHOT_IDENTIFIER` 未指定の場合必須)                                                      | 指定する場合、`SNAPSHOT_IDENTIFIER` は指定しません。 既存の DB クラスター ID。 例: `clone-test-aurora-cluster`                                                                                                                                                            |
| `AURORA_STORAGE_TYPE`        | Aurora ストレージタイプ                                                                                                                                                                          | (新規作成・更新時任意)                                                                                     | `aurora`, `aurora-iopt1`                                                                                                                                                                                                                                        |
| `SECRET_MANAGER_ARN`         | マスター認証情報に使用する Secrets Manager シークレットの ARN                                                                                                                                      | (新規作成時:<br>`MASTER_USERNAME`/`MASTER_PASSWORD` 未指定の場合優先)                                    | 新規作成時で、`MASTER_USERNAME`/`MASTER_PASSWORD` より優先されます。 ARN 形式 (`arn:aws:secretsmanager:リージョン:アカウントID:secret:シークレット名-xxxxxxxx`)。                                                                                                                |

## rds_config.csv  

| 列名 | 説明 | 必須/任意（このスクリプトの場合） | 補足説明 |
|---|---|---|---|
| `REGION` | AWS リージョン | **必須** | 例: `ap-northeast-1`。すべてのAWS CLIコマンドでリージョンを指定するために使用されます。 |
| `DB_IDENTIFIER` | RDS DBインスタンスの一意の識別子 | **必須** | インスタンスの名前として使用されます。既に存在する場合は更新、存在しない場合は新規作成または復元が行われます。 |
| `ENGINE` | 使用するデータベースエンジンの名前 | **新規作成時: 必須**<br>復元時: スクリプトでは使用されません | 例: `mysql`, `postgres`, `mariadb`。新規作成時にのみ使用されます。復元元のスナップショットまたはインスタンスからエンジンは判別されるため、復元時のCSVでは不要です。 |
| `ENGINE_VERSION` | データベースエンジンのバージョン | **新規作成時: 必須**<br>復元時: スクリプトでは使用されません | 例: `8.0.34`, `17.4`, `10.11.11`。新規作成時にのみ使用されます。復元後にエンジンバージョンをアップグレードしたい場合は、別途 `modify-db-instance` を実行する必要があります。 |
| `INSTANCE_CLASS` | DBインスタンスのコンピューティングおよびメモリ容量 | 新規作成時: 必須<br>復元時: 任意<br>更新時: 任意 | 例: `db.t3.medium`。インスタンスのサイズを指定します。新規作成時は必須ですが、復元時や既存インスタンス更新時は、元の設定や既存設定からの変更として任意で指定可能です。 |
| `STORAGE_TYPE` | DBインスタンスのストレージタイプ | 新規作成時: 必須<br>復元時: 任意<br>更新時: 任意 | 例: `gp3` (汎用 SSD)。新規作成時は必須ですが、復元時や既存インスタンス更新時は、元の設定や既存設定からの変更として任意で指定可能です。 |
| `ALLOCATED_STORAGE` | DBインスタンスに割り当てるストレージ容量 (GiB) | **新規作成時: 必須**<br>復元時: スクリプトでは使用されません<br>更新時: 任意 | 例: `20`。新規作成時にのみ使用されます。復元時にはスナップショット/ソースのサイズが適用されます。既存インスタンスのストレージ容量を増やす場合は更新時に指定可能です。 |
| `MAX_ALLOCATED_STORAGE` | DBインスタンスのストレージ自動スケーリングの上限 (GiB) | 任意 | 例: `100`。ストレージ自動スケーリングに使用されます。新規作成時および既存インスタンス更新時に任意で指定可能です。 |
| `DB_NAME` | DBインスタンス作成時に作成するデータベースの名前 | 新規作成時: 任意<br>復元時: スクリプトでは使用されません | 例: `mydb`。新規作成時にのみ使用されます。復元時には復元元のデータベースが使用されます。 |
| `MASTER_USERNAME` | マスターユーザーのユーザー名 | **新規作成時: 必須 (SECRET_MANAGER_ARN が未指定の場合)**<br>復元時: 不要 | 例: `adminuser`。Secrets Manager ARN (`SECRET_MANAGER_ARN`) が指定されていない場合に、マスターパスワードと共に新規作成時に必須です。復元時には、復元元の認証情報が引き継がれます。 |
| `MASTER_PASSWORD` | マスターユーザーのパスワード | **新規作成時: 必須 (SECRET_MANAGER_ARN が未指定の場合)**<br>復元時: 不要 | 例: `MySQL#1234`。Secrets Manager ARN (`SECRET_MANAGER_ARN`) が指定されていない場合に、マスターユーザー名と共に新規作成時に必須です。復元時には、復元元の認証情報が引き継がれます。 |
| `VPC_SG_IDS` | VPC セキュリティグループ名または ID のセミコロン区切りリスト | 任意 | 例: `test-rds-sg;sg-040cbdf6d8b8c55d0`。スクリプトは名前形式で指定された場合はIDに変換します。新規作成、復元、更新のいずれの場合も任意で指定可能です。 |
| `SUBNET_GROUP` | DBインスタンスに使用する DB サブネットグループの名前 | **必須** | 例: `test-db-subnet`。新規作成、スナップショットからの復元、ポイントインタイムリカバリのいずれの場合も必須です。 |
| `PARAM_GROUP` | DBインスタンスに関連付ける DB パラメータグループの名前 | 新規作成時: 任意<br>復元時: スクリプトでは使用されません<br>更新時: 任意 | 例: `default.mariadb10.11`。新規作成時および既存インスタンス更新時に任意で指定可能です。復元時には復元元の設定が引き継がれます。 |
| `OPT_GROUP` | DBインスタンスに関連付けるオプショングループの名前 | 新規作成時: 任意<br>復元時: スクリプトでは使用されません<br>更新時: 任意 | 例: `default:mariadb-10-11`。新規作成時および既存インスタンス更新時に任意で指定可能です。復元時には復元元の設定が引き継がれます。 |
| `PUBLIC_ACCESS` | DBインスタンスがパブリックにアクセス可能かどうかを指定 | 任意 | `TRUE` または `FALSE`。新規作成、復元、更新のいずれの場合も任意で指定可能です。 |
| `ENABLE_PERFORMANCE_INSIGHTS` | Performance Insights を有効にするかどうかを指定 | 新規作成時: 任意<br>復元時: スクリプトでは使用されません<br>更新時: 任意 | `TRUE` または `FALSE`。新規作成時および既存インスタンス更新時に任意で指定可能です。復元時には直接指定できません。 |
| `BACKUP_RETENTION` | 自動バックアップの保持日数 | 新規作成時: 任意<br>復元時: スクリプトでは使用されません<br>更新時: 任意 | 例: `7`。指定しない場合、デフォルトは 1 日です。新規作成時および既存インスタンス更新時に任意で指定可能です。復元時には復元元の設定が引き継がれます。 |
| `BACKUP_WINDOW` | 自動バックアップが作成される日次時間範囲 (UTC) | 新規作成時: 任意<br>復元時: スクリプトでは使用されません<br>更新時: 任意 | 例: `04:00-05:00`。新規作成時および既存インスタンス更新時に任意で指定可能です。復元時には復元元の設定が引き継がれます。 |
| `MAINTENANCE_WINDOW` | システムメンテナンスが実行される週次時間範囲 (UTC) | 新規作成時: 任意<br>復元時: スクリプトでは使用されません<br>更新時: 任意 | 例: `mon:05:00-mon:06:00`。新規作成時および既存インスタンス更新時に任意で指定可能です。復元時には復元元の設定が引き継がれます。 |
| `PERFORMANCE_RETENTION` | Performance Insights データの保持期間 (日数) | 新規作成時: 任意<br>復元時: スクリプトでは使用されません<br>更新時: 任意 | 例: `7`。`ENABLE_PERFORMANCE_INSIGHTS` が `TRUE` の場合にのみ新規作成時および既存インスタンス更新時に意味を持ちます。復元時には直接指定できません。 |
| `TAGS` | DBインスタンスに関連付けるタグのセミコロン区切りリスト | 任意 | 例: `Environment=Dev;Owner=MySQLUser`。各タグは `キー=値` の形式です。新規作成、復元、更新のいずれの場合も任意で指定可能です。 |
| `MULTI_AZ` | DBインスタンスがマルチ AZ 配置かどうかを指定 | 任意 | `TRUE` または `FALSE`。新規作成、復元、更新のいずれの場合も任意で指定可能です。 |
| `LOG_EXPORTS` | CloudWatch Logs に公開するログタイプをセミコロン区切りで指定 | 新規作成時: 任意<br>復元時: スクリプトでは使用されません<br>更新時: 任意 | 例: `error;general;slowquery`。有効なログタイプはデータベースエンジンによって異なります。新規作成時および既存インスタンス更新時に任意で指定可能です。復元時には直接指定できません。 |
| `SNAPSHOT_IDENTIFIER` | 復元元の DB スナップショットの ID | 復元時: 必須 (新規作成、SOURCE_DB_IDENTIFIER と排他) | インスタンスを特定のスナップショットから復元する場合に指定します。この項目を指定した場合、他の新規作成関連の項目は使用されません。`SOURCE_DB_IDENTIFIER` と同時に指定できません。 |
| `SOURCE_DB_IDENTIFIER` | ポイントインタイムリカバリのソース DB インスタンスの識別子 | 復元時: 必須 (新規作成、SNAPSHOT_IDENTIFIER と排他) | インスタンスをポイントインタイムリカバリする場合に指定します。この項目を指定した場合、他の新規作成関連の項目は使用されません。`SNAPSHOT_IDENTIFIER` と同時に指定できません。<br>**注意:** 復元先のインスタンスIDは `DB_IDENTIFIER` で指定します。 |
| `SECRET_MANAGER_ARN` | マスター認証情報を含む Secrets Manager シークレットの ARN | 新規作成時: 必須 (MASTER_USERNAME/MASTER_PASSWORD と排他) | 指定すると、`MASTER_USERNAME` と `MASTER_PASSWORD` よりも優先されます。新規作成時にのみ使用されます。 |
| `DELETION_PROTECTION` | DBインスタンスの削除保護を有効にするかどうかを指定 | 任意 | `TRUE` または `FALSE`。新規作成、復元、更新のいずれの場合も任意で指定可能です。 |

