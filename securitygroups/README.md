# CSV  
## securitygroups.csv  

| 列名             | 説明                                                                                                                               | 必須/任意                                     | 補足                                                                                                                                                              |
| :--------------- | :--------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `REGION`         | セキュリティグループおよびルールを操作するAWSリージョンを指定します。                                                                    | 必須                                          | スクリプト内のすべてのAWS CLIコマンドで使用されます。                                                                                                               |
| `VPC_IDENTIFIER` | セキュリティグループが存在する、または作成されるVPCを識別します。VPC IDまたはVPCのNameタグの値を指定できます。                                       | 必須                                          | スクリプトは `get_vpc_id` 関数を使用してこの値をVPC IDに解決します。新しいセキュリティグループの作成時や既存の検索時に使用されます。                                                        |
| `GROUP_NAME`     | 操作対象となるセキュリティグループの名前です。                                                                                           | 必須                                          | スクリプトは、指定されたVPC内でこの名前のセキュリティグループを見つけるか、または新しいものを作成する際に使用します。                                                                              |
| `DESCRIPTION`    | セキュリティグループ自体の説明です。                                                                                                   | セキュリティグループ作成時 必須<br>(CSV定義上は常に必要) | スクリプトが新しいセキュリティグループを作成する際に `--description` として使用されます。既存のセキュリティグループに対してルールを追加/削除する行では、この列の値はスクリプトの作成ロジックでは直接使用されません。        |
| `ACTION`         | この行で定義されたルールに対して実行するアクションを指定します。                                                                           | 必須                                          | スクリプトは `"add"` を `authorize` (`追加`)、`"remove"` を `revoke` (`削除`) にマッピングします。サンプルCSVの `"adde"` はスクリプトの条件判定により `"add"` とみなされます。          |
| `DIRECTION`      | ルールを適用するトラフィックの方向です。                                                                                             | 必須                                          | スクリプトは、実行するAWS CLIコマンド (`authorize-security-group-ingress`/`egress` または `revoke-security-group-ingress`/`egress`) を決定するために使用します。                 |
| `PROTOCOL`       | ルールが適用されるIPプロトコルです。                                                                                                 | 必須                                          | スクリプトは `--ip-permissions` パラメータの `IpProtocol` として使用します。`-1` はすべてのプロトコルを表す特別な値です。                                                                 |
| `FROM_PORT`      | ポート範囲の開始ポートです。                                                                                                         | 条件付き必須 (tcp/udpの場合)                    | `PROTOCOL` が `tcp` または `udp` の場合に `--ip-permissions` パラメータの `FromPort` として使用されます。`PROTOCOL` が `-1` の場合、この列はスクリプトにより無視されます。単一ポートの場合は `TO_PORT` と同じ値を指定します。 |
| `TO_PORT`        | ポート範囲の終了ポートです。                                                                                                         | 条件付き必須 (tcp/udpの場合)                    | `PROTOCOL` が `tcp` または `udp` の場合に `--ip-permissions` パラメータの `ToPort` として使用されます。`PROTOCOL` が `-1` の場合、この列はスクリプトにより無視されます。単一ポートの場合は `FROM_PORT` と同じ値を指定します。 |
| `TARGET`         | トラフィックの送信元 (ingressの場合) または宛先 (egressの場合) を指定します。CIDR、セキュリティグループ (名前またはID)、プレフィックスリスト (名前またはID) を指定できます。 | 必須                                          | スクリプトは、この値が CIDR、セキュリティグループID (`sg-`)、セキュリティグループ名、プレフィックスリストID (`pl-`)、またはプレフィックスリスト名であるかを順に判定し、適切な `--ip-permissions` の設定 ( `IpRanges`、`UserIdGroupPairs`、`PrefixListIds` ) を生成します。 |
| `RULE_DESCRIPTION` | この特定のルールに対する説明です。                                                                                                   | 任意                                          | スクリプトは、`ACTION` が `"add"` (または `"adde"`) の場合に、追加されるルールに付与する説明として使用します。                                                                         |
